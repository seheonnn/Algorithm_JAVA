- 특정 기간동안 대여 가능한 자동차들의 대여비용 구하기

```
SELECT A.CAR_ID, P.CAR_TYPE, FLOOR((A.DAILY_FEE * 30) * (1-P.DISCOUNT_RATE/100)) AS FEE FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN P 
LEFT JOIN 
(SELECT *
FROM CAR_RENTAL_COMPANY_CAR 
WHERE CAR_ID NOT IN 
 # 11-01 ~ 11-30 사이에 예약 있는 차들 제외
 (SELECT CAR_ID
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
WHERE (START_DATE < '2022-11-01' AND '2022-11-01' < END_DATE) 
OR ('2022-11-01' < START_DATE AND END_DATE < '2022-11-30') 
OR (START_DATE < '2022-11-30' AND '2022-11-30' < END_DATE) )) A
ON P.CAR_TYPE = A.CAR_TYPE
WHERE P.CAR_TYPE IN ('세단', 'SUV')
AND P.DURATION_TYPE LIKE '30%'
# 30일간의 대여 금액이 50만원 이상, 200만원 미만
AND ((A.DAILY_FEE * 30) * (1-P.DISCOUNT_RATE/100)) >= 500000
AND ((A.DAILY_FEE * 30) * (1-P.DISCOUNT_RATE/100)) < 2000000
ORDER BY ((A.DAILY_FEE * 30) * (1-P.DISCOUNT_RATE/100)) DESC
```
